% No09.マズルフラッシュを作成しよう！

<div class="main">

## 概要

本章では、今までに覚えた知識を用いてマズルフラッシュのエフェクトを作成します。
マズルフラッシュとは、銃を撃った時に先端に出現する火です。
射撃があるゲームでは、マズルフラッシュは必須です。

<div align="center">
<img src="../../img/Tutorial/09_completed.gif">
<p>マズルフラッシュ</p>
</div>

## マズルフラッシュ

マズルフラッシュの構造を分解してみます。
本章で作成するマズルフラッシュは、大きく分けて3つのパーツで構成されます。
それは、閃光、煙、火花の3つです。

図(分解図)

複雑なエフェクトを作成する場合は、パーツごとに分けて考えることが大事です。
それぞれのパーツの作成方法を説明します。

あらかじめ作成途中のエフェクトを下記のリンクからダウンロードできるようにしました。

<div align="center">
<a href = "../../Sample/09_01_Sample.zip">ダウンロード</a>
</div>

### 閃光

閃光は3種類のスプライトで表現します。
弾が移動する方向をZとします。
XY方向に広がる閃光2種類と、全方向に広がる1種類です。

XY方向に広がる閃光は、配置を固定にしたスプライトで表現します。
表現を豊かにするために、拡大して消えるスプライトと縮小して消えるスプライトを用意します。
いずれも一瞬だけ表示されるだけなので、20フレーム程度で消えるようにします。

全方向に広がるスプライトは拡大して消えるようにします。

パラメーターは以下のようになります。

閃光エフェクトは以下の映像のようになりました。

画像

### 煙

煙は煙の画像が表示された複数のスプライトで表現します。

弾が移動する方向に移動するようにしつつ、若干上に向かうようにします。

煙の画像は4枚のアニメーションで構成されています。
一定時間経過するごとに画像を切り替えることで、煙が変化しているように見せます。

パラメーターは以下のようになります。

煙エフェクトは以下の映像のようになりました。

画像

### 火花

火花は丸い画像が表示された複数のスプライトで表現します。
ただ、火花が飛び散る方向を指定するために親子関係を用います。

弾が移動する方向を軸に円形に火花が配置されるので、親のノードの生成方法に円を指定します。
火花が円の外側を向くようにするために、角度に影響にチェックします。

そうすると、子のパーティクルは弾が移動する方向に進むためには、Y方向に移動、外側に移動するにはZ方向に移動すればいいようになります。

図

それに加えて、親のノードを若干外側に回転させます。そうすると、子のY方向がやや外側に向きます。

図

子のパーティクルは最初は長く、最後は短くなるようにします。
それを、移動と拡大のイージングで実現しています。

パラメーターは以下のようになります。

火花エフェクトは以下の映像のようになりました。

画像


### 統合

3つのパーツを同時に表示してみました。
マズルフラッシュのエフェクトが作成できました。

映像

最後に、本章で作成されたエフェクトをダウンロードできるようにしてみました。

<div align="center">
<a href = "../../Sample/09_02_Sample.zip">ダウンロード</a>
</div>

## まとめ

本章では、実際にゲームで使用できそうなエフェクトを作成しました。 
次章では、エフェクトを作成する上での細かいテクニックを説明します。

</div>